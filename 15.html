<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</title>
<style>
body {
font-family: 'Sarabun', 'Arial', sans-serif;
line-height: 1.6;
color: #333;
max-width: 1200px;
margin: 0 auto;
padding: 20px;
background-color: #f5f5f5;
position: relative;
padding-bottom: 60px;
}
h1 {
color: #2c3e50;
text-align: center;
margin-bottom: 30px;
}
.container {
display: flex;
flex-direction: column;
gap: 20px;
}
.input-section, .output-section {
background: white;
padding: 20px;
border-radius: 8px;
box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}
textarea {
width: 100%;
height: 200px;
padding: 10px;
border: 1px solid #ddd;
border-radius: 4px;
resize: vertical;
font-family: monospace;
}
button {
background-color: #3498db;
color: white;
border: none;
padding: 10px 20px;
border-radius: 4px;
cursor: pointer;
font-size: 16px;
margin-top: 10px;
transition: background-color 0.3s;
}
button:hover {
background-color: #2980b9;
}
pre {
background-color: #f8f9fa;
padding: 15px;
border-radius: 4px;
overflow-x: auto;
white-space: pre-wrap;
word-wrap: break-word;
}
.instructions {
background-color: #e7f5ff;
padding: 15px;
border-left: 4px solid #3498db;
margin-bottom: 20px;
border-radius: 6px;
}
.file-upload {
margin-bottom: 15px;
display: flex;
align-items: center;
gap: 10px;
}
.file-name {
font-style: italic;
color: #666;
}
.button-group {
display: flex;
gap: 10px;
margin-top: 15px;
}
#clearBtn {
background-color: #e74c3c;
}
#clearBtn:hover {
background-color: #c0392b;
}
.success {
color: #27ae60;
font-weight: bold;
}
.error {
color: #e74c3c;
font-weight: bold;
}
.input-section {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-left: 5px solid #3498db;
        position: relative;
        overflow: hidden;
    }
    
    .input-section::before {
        content: "";
        position: absolute;
        top: -50px;
        right: -50px;
        width: 100px;
        height: 100px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
    }
    
    .input-section h2 {
        color: #2c3e50;
        margin-top: 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .input-section h2::before {
        content: "üì•";
        font-size: 1.5em;
    }
    
    .file-upload {
        background: rgba(255, 255, 255, 0.7);
        padding: 10px 15px;
        border-radius: 6px;
        border: 1px dashed #3498db;
    }
    
    #fileInput {
        padding: 8px;
        background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
        color: white;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    #fileInput:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    textarea {
        border: 2px solid #3498db;
        background-color: #eef5ff;
        transition: all 0.3s;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    textarea:focus {
        outline: none;
        border-color: #2c3e50;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3), inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .button-group {
        display: flex;
        gap: 15px;
    }
    
    #convertBtn {
        background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        position: relative;
        overflow: hidden;
    }
    
    #convertBtn::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 5px;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
        opacity: 0;
        border-radius: 100%;
        transform: scale(1, 1) translate(-50%);
        transform-origin: 50% 50%;
    }
    
    #convertBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }
    
    #convertBtn:active::after {
        animation: ripple 1s ease-out;
    }
    
    #clearBtn {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
    }
    
    #clearBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }
    
    @keyframes ripple {
        0% {
            transform: scale(0, 0);
            opacity: 1;
        }
        20% {
            transform: scale(25, 25);
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: scale(40, 40);
        }
    }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå */
    .result-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 14px;
    }
    
    .result-table th, .result-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }
    
    .result-table th {
        background-color: #3498db;
        color: white;
    }
    
    .result-table tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    
    .result-table tr:hover {
        background-color: #e6f3ff;
    }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å */
    .homeButton {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        transition: all 0.3s;
        font-family: 'Sarabun', 'Arial', sans-serif;
    }

    .homeButton:hover {
        background-color: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö footer */
    footer {
        text-align: center;
        margin-top: 40px;
        padding: 15px;
        color: #666;
        border-top: 1px solid #ddd;
        font-family: 'Sarabun', 'Arial', sans-serif;
    }
    
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•Îìú XLSX */
    #downloadBtn {
        background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
    }
    
    #downloadBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }
    
    .output-buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        flex-wrap: wrap;
    }
    
    .info-box {
        background-color: #e7f5ff;
        padding: 15px;
        border-radius: 6px;
        margin-top: 20px;
        border-left: 4px solid #3498db;
    }
    
    .highlight {
        background-color: #fffacd;
        padding: 2px 5px;
        border-radius: 3px;
        font-weight: bold;
    }
    
    .number-example {
        display: flex;
        align-items: center;
        gap: 5px;
        margin: 10px 0;
        flex-wrap: wrap;
    }
    
    .number-part {
        padding: 5px 10px;
        border-radius: 4px;
        background: #f0f8ff;
        border: 1px solid #3498db;
    }
    
    .arrow {
        font-size: 18px;
        color: #3498db;
    }
    
    @media (max-width: 768px) {
        .result-table {
            font-size: 12px;
        }
        
        .output-buttons {
            flex-direction: column;
        }
        
        button {
            width: 100%;
        }
    }
    
    .timestamp-info {
        margin-top: 10px;
        font-size: 14px;
        color: #666;
        font-style: italic;
    }

    .number-cell {
        font-family: monospace;
        letter-spacing: 1px;
    }
    
    .excel-guide {
        margin-top: 20px;
        padding: 15px;
        background-color: #f9f9f9;
        border-radius: 6px;
        border-left: 4px solid #27ae60;
    }
    
    .excel-guide h3 {
        margin-top: 0;
        color: #2c3e50;
    }
    
    .excel-steps {
        margin-left: 20px;
    }
    
    .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255,255,255,.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
        margin-right: 10px;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
</style>
<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ SheetJS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå XLSX -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
<h1>‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h1>
<div class="container">
    <div class="instructions">
        <p>‡∏ß‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå .txt ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
    
    <div class="input-section">
        <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</h2>
        <div class="file-upload">
            <input type="file" id="fileInput" accept=".txt">
            <span id="fileName" class="file-name">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</span>
        </div>
        <textarea id="inputData" placeholder="‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
        <div class="button-group">
            <button id="convertBtn">‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button id="clearBtn">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
    </div>
    
    <div class="output-section">
        <h2>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
        <div id="status"></div>
        <div id="outputResult"></div>
        <div class="output-buttons">
            <button id="copyBtn">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
            <button id="downloadBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel (XLSX)</button>
        </div>

    </div>
</div>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
<button id="homeButton" class="homeButton" onclick="window.location.href='https://juckmanphai.github.io/4/index.html'">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>

<!-- Footer -->
<footer>
    <div>
        &copy; 2025 Juckmanphai. All Rights Reserved.
    </div>
</footer>

<script>
    // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡πÑ‡∏î‡πâ
    let filteredData = [];
    
    document.getElementById('fileInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        document.getElementById('fileName').textContent = file.name;
        document.getElementById('status').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå...';
        document.getElementById('status').className = '';
        
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('inputData').value = e.target.result;
            document.getElementById('status').textContent = '‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
            document.getElementById('status').className = 'success';
        };
        reader.onerror = function() {
            document.getElementById('status').textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå';
            document.getElementById('status').className = 'error';
        };
        reader.readAsText(file);
    });
    
    document.getElementById('convertBtn').addEventListener('click', function() {
        const inputData = document.getElementById('inputData').value;
        if (!inputData.trim()) {
            document.getElementById('status').textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô';
            document.getElementById('status').className = 'error';
            return;
        }
        
        document.getElementById('status').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
        document.getElementById('status').className = '';
        
        try {
            let rawData = filterLaoLotteryData(inputData);
            // Sort the data by date from oldest to newest
            filteredData = sortDataByDate(rawData);
            displayResults(filteredData);
            document.getElementById('status').textContent = '‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏û‡∏ö ' + filteredData.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
            document.getElementById('status').className = 'success';
        } catch (error) {
            document.getElementById('status').textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message;
            document.getElementById('status').className = 'error';
            console.error(error);
        }
    });
    
    document.getElementById('clearBtn').addEventListener('click', function() {
        document.getElementById('inputData').value = '';
        document.getElementById('outputResult').innerHTML = '';
        document.getElementById('status').textContent = '';
        document.getElementById('fileInput').value = '';
        document.getElementById('fileName').textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå';
        filteredData = [];
    });
    
    document.getElementById('copyBtn').addEventListener('click', function() {
        if (filteredData.length === 0) {
            document.getElementById('status').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å';
            document.getElementById('status').className = 'error';
            return;
        }
        
        let csvContent = "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 6 ‡∏ï‡∏±‡∏ß,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 4 ‡∏ï‡∏±‡∏ß,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 3 ‡∏ï‡∏±‡∏ß\n";
        filteredData.forEach(item => {
            // ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö CSV ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©
            csvContent += `${item.date},${item.number6},${item.number4},${item.number3}\n`;
        });
        
        navigator.clipboard.writeText(csvContent)
            .then(() => {
                document.getElementById('status').textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß!';
                document.getElementById('status').className = 'success';
            })
            .catch(err => {
                document.getElementById('status').textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + err;
                document.getElementById('status').className = 'error';
            });
    });
    
    document.getElementById('downloadBtn').addEventListener('click', function() {
        if (filteredData.length === 0) {
            document.getElementById('status').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î';
            document.getElementById('status').className = 'error';
            return;
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
        document.getElementById('status').innerHTML = '<span class="loading"></span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel...';
        document.getElementById('status').className = '';
        
        // ‡πÉ‡∏ä‡πâ setTimeout ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ UI ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
        setTimeout(function() {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á workbook ‡πÉ‡∏´‡∏°‡πà
                const wb = XLSX.utils.book_new();
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô worksheet
                const wsData = [
                    ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 6 ‡∏ï‡∏±‡∏ß", "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 4 ‡∏ï‡∏±‡∏ß", "‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 3 ‡∏ï‡∏±‡∏ß"]
                ];
                
                filteredData.forEach(item => {
                    wsData.push([item.date, item.number6, item.number4, item.number3]);
                });
                
                const ws = XLSX.utils.aoa_to_sheet(wsData);
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                const colWidths = [
                    { wch: 15 }, // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                    { wch: 12 }, // ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 6 ‡∏ï‡∏±‡∏ß
                    { wch: 12 }, // ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 4 ‡∏ï‡∏±‡∏ß
                    { wch: 12 }  // ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 3 ‡∏ï‡∏±‡∏ß
                ];
                ws['!cols'] = colWidths;
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ worksheet
                XLSX.utils.book_append_sheet(wb, ws, "‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß");
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                
                const dateTimeString = `${year}${month}${day}_${hours}${minutes}${seconds}`;
                const fileName = `‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß_${dateTimeString}.xlsx`;
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå XLSX ‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                XLSX.writeFile(wb, fileName);
                
                document.getElementById('status').textContent = '‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + fileName;
                document.getElementById('status').className = 'success';
            } catch (error) {
                document.getElementById('status').textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå: ' + error.message;
                document.getElementById('status').className = 'error';
                console.error(error);
            }
        }, 100);
    });
    
    function filterLaoLotteryData(input) {
        const results = [];
        
        // 1. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö HTML (‡∏£‡∏ß‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡∏°‡πà)
        // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: <td ... title=" ...">05/09/2568</a></td><td ...>078775</td>
        const htmlPattern = /<td[^>]*>(?:<a[^>]*title="[^>]*>)?(\d{2}\/\d{2}\/\d{4})(?:<\/a>)?<\/td>\s*<td[^>]*>(\d{6})<\/td>/g;
        let htmlMatch;
        while ((htmlMatch = htmlPattern.exec(input)) !== null) {
            const date = htmlMatch[1];
            const number6 = htmlMatch[2];
            const number4 = number6.slice(2);
            const number3 = number6.slice(3);
            
            results.push({ date, number6, number4, number3 });
        }
        
        // 2. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÄ‡∏î‡∏¥‡∏°)
        const lines = input.split('\n');
        for (const line of lines) {
            if (!line.trim()) continue;
            
            if (line.includes('‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß')) {
                // ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                const dateMatch = line.match(/‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô\S+\s+(\d+)\s+(\S+)\s+(\d+)/);
                if (!dateMatch) continue;
                
                const day = dateMatch[1].padStart(2, '0');
                const month = convertMonthToNumber(dateMatch[2]);
                const year = dateMatch[3];
                const date = `${day}/${month}/${year}`;
                
                // ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏Ç 6 ‡∏ï‡∏±‡∏ß
                const numberMatch = line.match(/‡πÄ‡∏•‡∏Ç 6 ‡∏ï‡∏±‡∏ß\s+(\d{6})/);
                if (!numberMatch) continue;
                
                const number6 = numberMatch[1];
                const number4 = number6.slice(2);
                const number3 = number6.slice(3);
                
                results.push({ date, number6, number4, number3 });
            }
        }
        
        return results;
    }

    function sortDataByDate(data) {
        return data.sort((a, b) => {
            // Convert DD/MM/YYYY to YYYY-MM-DD for correct date comparison
            const [dayA, monthA, yearA] = a.date.split('/');
            const dateA = new Date(`${yearA}-${monthA}-${dayA}`);

            const [dayB, monthB, yearB] = b.date.split('/');
            const dateB = new Date(`${yearB}-${monthB}-${dayB}`);
            
            return dateA - dateB;
        });
    }
    
    function convertMonthToNumber(monthName) {
        const months = {
            '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°': '01',
            '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå': '02',
            '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°': '03',
            '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô': '04',
            '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°': '05',
            '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô': '06',
            '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°': '07',
            '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°': '08',
            '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô': '09',
            '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°': '10',
            '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô': '11',
            '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°': '12'
        };
        
        return months[monthName] || '00';
    }
    
    function displayResults(data) {
        const outputDiv = document.getElementById('outputResult');
        
        if (data.length === 0) {
            outputDiv.innerHTML = '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ß‡∏¢‡∏•‡∏≤‡∏ß‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏õ‡πâ‡∏≠‡∏ô</p>';
            return;
        }
        
        let tableHTML = `
            <table class="result-table" id="outputTable">
                <thead>
                    <tr>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th>‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 6 ‡∏ï‡∏±‡∏ß</th>
                        <th>‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 4 ‡∏ï‡∏±‡∏ß</th>
                        <th>‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 3 ‡∏ï‡∏±‡∏ß</th>
                    </tr>
                </thead>
                <tbody>
        `;
        
        data.forEach(item => {
            tableHTML += `
                <tr>
                    <td>${item.date}</td>
                    <td class="number-cell"><strong>${item.number6}</strong></td>
                    <td class="number-cell">${item.number4}</td>
                    <td class="number-cell">${item.number3}</td>
                </tr>
            `;
        });
        
        tableHTML += `
                </tbody>
            </table>
            <p style="margin-top: 15px;">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Excel ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î" ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel</p>
        `;
        
        outputDiv.innerHTML = tableHTML;
    }
    
  // Load sample data on page load for demonstration
    window.addEventListener('load', function() {
        const sampleData = ``;
document.getElementById('inputData').value = sampleData;
    });
</script>
</body>
</html>
